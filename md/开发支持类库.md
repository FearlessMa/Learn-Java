# å¼€å‘æ”¯æŒç±»åº“

## ç¬¬12ç«  Â» è¯¾æ—¶47 UUIDç±»

* UUIDæ˜¯ä¸€ç§ç”Ÿæˆæ— é‡å¤çš„å­—ç¬¦ä¸²ç±»ï¼Œè¿™ç§ç¨‹åºç±»çš„ä¸»è¦ç›®çš„æ˜¯æ ¹æ®æ—¶é—´æˆ³è‡ªåŠ¨çš„å®ç°æ— é‡å¤å­—ç¬¦ä¸²ã€‚(æœ¬è´¨æ˜¯æœ‰å¾ˆä½å‡ ç‡å‡ºç°é‡å¤çš„ï¼Œæ¦‚ç‡åƒä¸‡äº¿åˆ†ä¹‹ä¸€ã€‚)

```java
Module java.base
Package java.util
Class UUID
```

* ä¸€èˆ¬è·å–UUIDéƒ½æ˜¯éšæœºç”Ÿæˆçš„æ¨¡å¼ï¼Œæ‰€æœ‰å¯ä»¥ä½¿ç”¨å¦‚ä¸‹åŠŸèƒ½å®ç°ï¼š
    * è·å–UUIDå¯¹è±¡ï¼š public static UUID randomUUIDâ€‹()
    * ä»å­—ç¬¦ä¸²å›åˆ°UUIDï¼š public static UUID fromStringâ€‹(String name)

* ä»€ä¹ˆæ—¶å€™ä½¿ç”¨UUIDï¼Œä¸€èˆ¬å¯¹æ–‡ä»¶è‡ªåŠ¨å‘½åæ—¶ä½¿ç”¨UUID

```java
import java.util.UUID;
public class JavaDemo53{
    public static void main(String[] args) {
        //è·å–UUIDå¯¹è±¡
        UUID uid = UUID.randomUUID();
        //è¾“å‡ºUUIDå¯¹è±¡ï¼Œé»˜è®¤è°ƒç”¨toStringè¾“å‡ºå­—ç¬¦ä¸²
        System.out.println(uid);
        //15f85631-b64f-4712-9e7e-e1e2e5b267d2
    }
}
```

## ç¬¬12ç«  Â» è¯¾æ—¶48 Optionalç±»

```java
Module java.base
Package java.util
Class Optional<T>
```

* Optionalç±»ä¸»è¦æ˜¯è¿›è¡Œnullçš„ç›¸å…³å¤„ç†ã€‚åœ¨ä»¥å‰ç¨‹åºå¼€å‘ä¹‹ä¸­ä¸ºé˜²æ­¢ç¨‹åºå‡ºç°ç©ºæŒ‡å‘å¼‚å¸¸ï¼Œä¸€èˆ¬æ˜¯è¿½åŠ nullçš„éªŒè¯ã€‚

* é¢„é˜²nullï¼Œä¸€èˆ¬è‡ªå¼•ç”¨æ¥æ”¶æ–¹è¢«åŠ¨è¿›è¡Œåˆ¤æ–­ï¼Œä¸ºäº†è§£å†³è¿™ç§è¢«åŠ¨çš„æ“ä½œï¼Œjavaç±»ä¸­æä¾›æœ‰ä¸€ä¸ªOptionalç±»ï¼Œè¿™ä¸ªç±»å¯ä»¥å®ç°ç©ºçš„å¤„ç†æ“ä½œã€‚åœ¨è¿™ä¸ªç±»é‡Œæä¾›æœ‰å¦‚ä¸‹æ“ä½œæ–¹æ³•
    * è¿”å›ç©ºæ•°æ®ï¼špublic static <T> Optional<T> emptyâ€‹()
    * è·å–æ•°æ®ï¼š public T getâ€‹()
    * ä¿å­˜æ•°æ®ä½†æ˜¯ä¸å…è®¸å‡ºç°null : public static <T> Optional<T> ofâ€‹(T value)
        * ä¿å­˜æ•°æ®å‡ºç°ç©ºï¼Œåˆ™æŠ›å‡ºNullPointerException 
    * ä¿å­˜æ•°æ®ä½†æ˜¯å…è®¸å‡ºç°null :public static <T> Optional<T> ofNullableâ€‹(T value)

    * ç©ºçš„æ—¶å€™è¿”å›å…¶ä»–æ•°æ®ï¼š public T orElseâ€‹(T other)

![](../img/Optional.png)

* ğŸŒ°ä¿®æ”¹ç¨‹åºæŒ‰ç…§æ­£è§„å®Œæˆ

```java
import java.util.Optional;

interface IMessage{
    public String getConnect();
}

class MessageImpl implements IMessage{
    @Override
    public String getConnect() {
        return "é“¾æ¥æˆåŠŸ";
    }
}

class MessageUtil{
    private MessageUtil(){};
    //é€šè¿‡OptionalåŒ…è£…å¯¹è±¡è¿›è¡Œå¯¹å…¶éªŒè¯
    public static  Optional<IMessage> getMessage(){
        return Optional.of(new MessageImpl());
    }
    public static void UseMessage(IMessage msg){
        // //é¢„é˜²null è‡ªå¼•ç”¨æ¥æ”¶æ–¹è¢«åŠ¨è¿›è¡Œåˆ¤æ–­
        // if(msg != null){
        //     System.out.println(msg.getConnect());
        // }

        // ä½¿ç”¨Optional
        System.out.println(msg.getConnect());
    }
}

public class JavaDemo53{
    public static void main(String[] args) {
        //ä½¿ç”¨nullä¼šç©ºæŒ‡å‘å¼‚å¸¸ NullPointerException
        MessageUtil.UseMessage(MessageUtil.getMessage().get());//é“¾æ¥æˆåŠŸ
    }
}
```

* å¦‚æœä¿å­˜æ•°æ®ä¸ºnullï¼Œå°±ä¼šåœ¨ä¿å­˜å‡ºå‡ºç°å¼‚å¸¸ã€‚

```java
public static  Optional<IMessage> getMessage(){
    return Optional.of(null);
}
// Exception in thread "main" java.lang.NullPointerException
// 	at java.base/java.util.Objects.requireNonNull(Objects.java:221)
// 	at java.base/java.util.Optional.<init>(Optional.java:107)
// 	at java.base/java.util.Optional.of(Optional.java:120)
// 	at MessageUtil.getMessage(JavaDemo53.java:20)
// 	at JavaDemo53.main(JavaDemo53.java:42)
```

* å¦‚æœä½¿ç”¨Optional.ofNullableä¸”ä½¿ç”¨getè·å–æ•°æ®å°±ä¼šå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼Œéœ€è¦æ›´æ¢getä¸ºorElseæ–¹æ³•ï¼Œç›¸å½“äºä¸ºå½“å€¼ä¸ºnullï¼Œè®¾ç½®Tï¼ˆæ³›å‹ï¼‰ç±»å‹é»˜è®¤å€¼

```java
public static  Optional<IMessage> getMessage(){
    return Optional.ofNullable(null);
}
// Exception in thread "main" java.util.NoSuchElementException: No value present
// 	at java.base/java.util.Optional.get(Optional.java:148)
// 	at JavaDemo53.main(JavaDemo53.java:42)

```

```java
// ç›¸å½“äºä¸ºå½“å€¼ä¸ºnullï¼Œè®¾ç½®Tç±»å‹é»˜è®¤å€¼
MessageUtil.UseMessage(MessageUtil.getMessage().orElse(new MessageImpl())); //é“¾æ¥æˆåŠŸ

```

* åœ¨æ‰€æœ‰å¼•ç”¨æ“ä½œå¤„ç†ä¸­nullæ˜¯ä¸€ä¸ªé‡è¦çš„æŠ€æœ¯é—®é¢˜ï¼Œæ‰€ä»¥jdk1.8ä¹‹åè¿™ä¸ªæ–°çš„ç±»å¯¹äºnullçš„å¤„ç†å¾ˆæœ‰å¸®åŠ©ã€‚

## ç¬¬12ç«  Â» è¯¾æ—¶49 ThreadLocalç±»

* ä»¥ä¸‹ç¨‹åºæ˜¯å•çº¿ç¨‹æ¨¡å¼å¤„ç†ï¼Œå¦‚æœåœ¨å¤šçº¿æ€§çŠ¶æ€ä¸‹èƒ½å¦å®ç°åŒæ ·æ•ˆæœã€‚

```java

class Channel {
    private static Message message;

    private Channel(){}

    public static void setMessage(Message m) {
        message = m;
    }

    public static void send() {
        System.out.println(message.getInfo());
    }
}

class Message {
    private String info;

    /**
     * @param message the message to set
     */
    public void setInfo(String message) {
        this.info = message;
    }

    /**
     * @return the message
     */
    public String getInfo() {
        return info;
    }
}

public class JavaDemo54 {
    public static void main(String[] args) {
        Message msg = new Message();
        msg.setInfo("message");
        Channel.setMessage(msg);
        Channel.send();//message
    }
}

```

* å¤šçº¿ç¨‹ä¸‹æ¶ˆæ¯ä¹‹é—´äº§ç”Ÿå½±å“

```java

class Channel {
    private static Message message;

    private Channel() {
    }

    public static void setMessage(Message m) {
        message = m;
    }

    public static void send() {
        System.out.println(Thread.currentThread().getName() + "-" + message.getInfo());
    }
}

class Message {
    private String info;

    /**
     * @param message the message to set
     */
    public void setInfo(String message) {
        this.info = message;
    }

    /**
     * @return the message
     */
    public String getInfo() {
        return info;
    }
}

public class JavaDemo54 {
    public static void main(String[] args) {
        new Thread(() -> {
            Message msg = new Message();
            msg.setInfo("message1");
            Channel.setMessage(msg);
            Channel.send();// message
        }, "çº¿ç¨‹A").start();
        new Thread(() -> {
            Message msg = new Message();
            msg.setInfo("message2");
            Channel.setMessage(msg);
            Channel.send();// message
        }, "çº¿ç¨‹B").start();
        new Thread(() -> {
            Message msg = new Message();
            msg.setInfo("message3");
            Channel.setMessage(msg);
            Channel.send();// message
        }, "çº¿ç¨‹C").start();
        // çº¿ç¨‹B-message2
        // çº¿ç¨‹A-message2
        // çº¿ç¨‹C-message3
    }
}
```

![](../img/ThreadLoacl.png)

* åœ¨ä¿æŒChannelæ ¸å¿ƒç»“æ„ä¸å˜çš„æƒ…å†µ,éœ€è¦è€ƒè™‘åˆ°æ¯ä¸ªçº¿ç¨‹çš„ç‹¬ç«‹æ“ä½œï¼Œ
å†è¿™æ ·çš„æƒ…å†µä¸‹å¯¹äºChannelç±»è€Œè¨€é™¤äº†è¦ä¿ç•™æ¶ˆæ¯ä¹‹å¤–ï¼Œè¿˜åº”è¯¥å¤šå­˜æ”¾æ¯ä¸€ä¸ªçº¿ç¨‹çš„æ ‡è®°(å½“å‰çº¿ç¨‹)ã€‚é‚£ä¹ˆè¿™æ—¶å€™å°±å¯ä»¥é€šè¿‡ThreadLocalç±»å­˜æ”¾æ•°æ®ã€‚

```java
Module java.base
Package java.lang
Class ThreadLocal<T>
```

* æä¾›å¦‚ä¸‹æ–¹æ³•

    * æ„é€ æ–¹æ³•ï¼špublic ThreadLocalâ€‹() åˆ›å»ºæ–°çš„ThreadLocalæ–¹æ³•
    * è®¾ç½®æ•°æ®ï¼š public void setâ€‹(T value)
    * è·å–æ•°æ®ï¼š public T getâ€‹()
    * åˆ é™¤æ•°æ®ï¼š public void removeâ€‹()


![](../img/ThreadLocal01.png)

![](../img/ThreadLocal02.png)

* è§£å†³çº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹é€šè¿‡ThreadLocalåªèƒ½ä¿å­˜ä¸€ä¸ªæ•°æ®

```java

class Channel {
    private static final ThreadLocal<Message> THREADLOCAL = new ThreadLocal<>();

    private Channel() {
    }

    public static void setMessage(Message m) {
        THREADLOCAL.set(m);;
    }

    public static void send() {
        System.out.println(Thread.currentThread().getName() + "-" + THREADLOCAL.get().getInfo());
    }
}

class Message {
    private String info;

    /**
     * @param message the message to set
     */
    public void setInfo(String message) {
        this.info = message;
    }

    /**
     * @return the message
     */
    public String getInfo() {
        return info;
    }
}

public class JavaDemo54 {
    public static void main(String[] args) {
        new Thread(() -> {
            Message msg = new Message();
            msg.setInfo("message1");
            Channel.setMessage(msg);
            Channel.send();// message
        }, "çº¿ç¨‹A").start();
        new Thread(() -> {
            Message msg = new Message();
            msg.setInfo("message2");
            Channel.setMessage(msg);
            Channel.send();// message
        }, "çº¿ç¨‹B").start();
        new Thread(() -> {
            Message msg = new Message();
            msg.setInfo("message3");
            Channel.setMessage(msg);
            Channel.send();// message
        }, "çº¿ç¨‹C").start();
        // çº¿ç¨‹B-message2
        // çº¿ç¨‹A-message2
        // çº¿ç¨‹C-message3
    }
}
```

## ç¬¬12ç«  Â» è¯¾æ—¶50 å®šæ—¶è°ƒåº¦

* å®šæ—¶å™¨

    *  å®šæ—¶å™¨çš„ä¸»è¦æ“ä½œæ˜¯å®šæ—¶ä»»åŠ¡ï¼Œåœ¨javaä¸­æä¾›æœ‰å®šæ—¶ä»»åŠ¡æ‰“çš„æ”¯æŒï¼Œè¿™ç§ä»»åŠ¡åªæ˜¯å®ç°äº†é—´éš”è§¦å‘çš„æ“ä½œã€‚
    * å¦‚æœè¦å®ç°å®šæ—¶æ“ä½œï¼Œä¸»è¦æœ‰ä¸€ä¸ªå®šæ—¶æ“ä½œçš„ä¸»ä½“ç±»ï¼Œä»¥åŠä¸€ä¸ªå®šæ—¶ä»»åŠ¡çš„æ§åˆ¶ã€‚

* æœ‰ä¸¤ä¸ªç¨‹åºç±»

    * java.util.TimerTaskç±»ï¼š å®ç°å®šæ—¶ä»»åŠ¡å¤„ç†
    * java.util.Timerç±»ï¼šè¿›è¡Œä»»åŠ¡çš„å¯åŠ¨ï¼Œå¯åŠ¨çš„æ–¹æ³•ï¼š
        * ä»»åŠ¡å¯åŠ¨ï¼š public void scheduleâ€‹(TimerTask task, long delay) å•ä½ä¸ºæ¯«ç§’
        * public void scheduleâ€‹(TimerTask task, Date time)
        * é—´éš”è§¦å‘ï¼š public void scheduleAtFixedRateâ€‹(TimerTask task, long delay, long period)

```java
Module java.base
Package java.util
Class Timer

public class Timer extends Object

/****************/
Module java.base
Package java.util
Class TimerTask

public abstract class TimerTask extends Object implements Runnable
```

![](../img/TimerTask.png)

```java
import java.util.Timer;
import java.util.TimerTask;

class MyTimerTask extends TimerTask {
    @Override
    public void run() {
        System.out.println(Thread.currentThread().getName());
    }
}

public class JavaDemo55 {
    public static void main(String[] args) {
        Timer t = new Timer();
        TimerTask ts = new MyTimerTask();
        t.scheduleAtFixedRate(ts, 500, 500);
    }
}
```


* jdkæä¾›çš„æœ€åŸå§‹çš„æ”¯æŒï¼Œå®é™…ä¸Šå¼€å‘ä¹‹ä¸­åˆ©ç”¨æ­¤ç±»æ–¹å¼è¿›è¡Œçš„å®šæ—¶å¤„ç†ä¼šéå¸¸å¤æ‚ã€‚

## ç¬¬12ç«  Â» è¯¾æ—¶51 Base64åŠ å¯†ä¸è§£å¯†

* jdk1.8å¼€å§‹æä¾›æœ‰ä¸€ç»„æ–°çš„åŠ å¯†å¤„ç†æ“ä½œç±»ã€‚Base64å¤„ç†ç±»

    * Base64.Encoder :è¿›è¡ŒåŠ å¯†å¤„ç†
        * åŠ å¯†å¤„ç†ï¼š public int encodeâ€‹(byte[] src)
    * Base64.Decoder :è¿›è¡Œè§£å¯†å¤„ç†
        * è§£å¯†å¤„ç†ï¼š public byte[] decodeâ€‹(String src)
```java
Module java.base
Package java.util
Class Base64
```

```java
import java.util.*;

public class JavaDemo55 {
    public static void main(String[] args) {
        String str = "æµ‹è¯•ä¿¡æ¯";
        byte[] b = Base64.getEncoder().encode(str.getBytes());
        String bStr = new String(b);
        System.out.println(bStr);// 5rWL6K+V5L+h5oGv
        byte[] res = Base64.getDecoder().decode(bStr);
        System.out.println(new String(res));
        // 5rWL6K+V5L+h5oGv
        // æµ‹è¯•ä¿¡æ¯
    }
}
```

* ç”±äºBase64æ˜¯å…¬ç‰ˆçš„ç®—æ³•åŠ å¯†ï¼Œå¹¶ä¸å®‰å…¨ï¼Œæœ€å¥½æ˜¯ä½¿ç”¨ç›å€¼æ“ä½œã€‚

    * ç›å€¼æ“ä½œï¼Œå°±æ˜¯æ··å…¥å…¶ä»–å­—ç¬¦ä¸²,æ‰“ä¹±æ­£å¸¸ç»“æœ

```java
public class JavaDemo55 {
    public static void main(String[] args) {
        String str1 = "abc";
        String str = "æµ‹è¯•ä¿¡æ¯" + "{" + str1 + "}";
        byte[] b = Base64.getEncoder().encode(str.getBytes());
        String bStr = new String(b);
        System.out.println(bStr);
        byte[] res = Base64.getDecoder().decode(bStr);
        System.out.println(new String(res));
    }
}
```

* å¦‚æœæ˜¯å¯†ç å­˜å‚¨ï¼Œå³ä½¿ç°åœ¨æœ‰ç›å€¼ï¼Œå‘ç°å®é™…æ•ˆæœä¹Ÿä¸æ˜¯å¾ˆå¥½ã€‚æœ€å¥½çš„åšæ³•æ˜¯å¤šæ¬¡åŠ å¯†ï¼Œæœ€å¥½çš„åšæ³•æ˜¯ä½¿ç”¨2-3ä¸­åŠ å¯†ç®—æ³•ã€‚