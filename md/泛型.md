# æ³›å‹

* jdk1.5ä¹‹åjavaä¸­è¿½åŠ äº†æ³›å‹ï¼Œä¸»è¦æ˜¯ä¸ºäº†è§£å†³ClassCastEx'ceptionçš„é—®é¢˜,åœ¨è¿›è¡Œå¯¹è±¡çš„å‘ä¸‹è½¬å‹æ—¶æ°¸è¿œéƒ½å¯èƒ½å­˜åœ¨å®‰å…¨éšæ‚£ã€‚javaå¸Œæœ›å¯ä»¥é€šè¿‡æ³›å‹æ…¢æ…¢è§£å†³æ‰æ­¤ç±»é—®é¢˜ã€‚

## æ³›å‹é—®é¢˜å¼•å‡º

* æè¿°x,yåæ ‡çš„å¤„ç†ç±»ï¼Œå¹¶å…è®¸ä¿å­˜ä¸‰ç±»æ•°æ®ã€‚
    * æ•´å‹æ•°æ®ï¼šx=10,y=20
    * æµ®ç‚¹å‹æ•°æ®ï¼š x=10.1,y=20.9
    * å­—ç¬¦ä¸²å‹ï¼šx=ä¸œç»20åº¦,y=åŒ—çº¬30åº¦
* è®¾è®¡Pointç±»éœ€è¦è€ƒè™‘å…·ä½“çš„x,yå±æ€§çš„ç±»å‹,è¦æ±‚å¯ä»¥ä¿å­˜ä»¥ä¸Šä¸‰ç§æ•°æ®ã€‚
    * Objectç±»å®šä¹‰
        * æ•´å‹æ•°æ®ï¼š åŸºæœ¬æ•°æ® -> ç»è¿‡åŒ…è£… Integerç±»å¯¹è±¡ -> è‡ªåŠ¨å‘ä¸Šè½¬å‹ä¸ºObject
        * æµ®ç‚¹å‹æ•°æ®ï¼š åŸºæœ¬æ•°æ® -> ç»è¿‡åŒ…è£… Doubleç±»å¯¹è±¡ -> è‡ªåŠ¨å‘ä¸Šè½¬å‹ä¸ºObject
        * å­—ç¬¦ä¸²å‹æ•°æ®ï¼š  Stringç±»å¯¹è±¡ -> è‡ªåŠ¨å‘ä¸Šè½¬å‹ä¸ºObject

```java
class Point {
    private Object x;
    private Object y;

    public void setX(Object x) {
        this.x = x;
    }

    public void setY(Object y) {
        this.y = y;
    }

    public Object getX() {
        return this.x;
    }

    public Object getY() {
        return this.y;
    }
}

public class JavaDemo12 {
    public static void main(String[] args) {
        Point p = new Point();
        p.setX(10);// è‡ªåŠ¨è£…ç®±
        p.setY(20);
        // è·å–xï¼Œy
        int x = (Integer) p.getX(); //æ‹†ç®±ï¼Œå‘ä¸‹è½¬å‹è·å–æ•°æ®
        int y = (Integer) p.getY();
        System.out.println("x=" + x + "ã€y=" + y);
        // x=10ã€y=20
    }
}
```

* ä»¥ä¸Šå¯ä»¥è§£å†³ï¼Œæ˜¯å› ä¸ºObjectå¯ä»¥æ¥æ”¶æ‰€æœ‰çš„æ•°æ®ç±»å‹ã€‚ä½†æ˜¯ä¼šå‡ºç°å®‰å…¨éšæ‚£ã€‚

```java
p.setX(10);// è‡ªåŠ¨è£…ç®±
p.setY("åŒ—çº¬30åº¦");
```
<strong>ç¼–è¯‘çš„æ—¶å€™ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œç¨‹åºæ‰§è¡Œæ—¶å€™å°±ä¼šå‡ºç°ClassCastException,æ‰€ä»¥ä¼šå­˜åœ¨å®‰å…¨éšæ‚£</strong>å®‰å…¨éšæ‚£å­˜åœ¨çš„æ ¹æœ¬æ˜¯å› ä¸ºObjectå¯ä»¥æ¥æ”¶æ‰€æœ‰ç±»å‹ã€‚

## æ³›å‹çš„åŸºæœ¬å®šä¹‰

* å¦‚æœæƒ³è¦é¿å…ClassCastExceptionï¼Œæœ€å¥½é¿å…æ‰å¯¹è±¡çš„å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚
* <strong color='red'>æ³›å‹çš„æœ¬è´¨ï¼Œç±»ä¸­çš„å±æ€§æˆ–æ–¹æ³•çš„å‚æ•°ä¸è¿”å›å€¼å¯ä»¥ç”±å¯¹è±¡å®ä¾‹åŒ–æ—¶åŠ¨æ€å†³å®šã€‚</strong>æ­¤æ—¶åœ¨ç±»å®šä¹‰æ—¶ï¼Œå°±éœ€è¦æ˜ç¡®çš„å ä½ç¬¦(æ³›å‹æ ‡è®°)

```java
class Point<T> { //Tæ˜¯Typeçš„ç®€å†™,å¯ä»¥å®šä¹‰å¤šä¸ªæ³›å‹
    private T x;
    private T y;

    public void setX(T x) {
        this.x = x;
    }

    public void setY(T y) {
        this.y = y;
    }

    public T getX() {
        return this.x;
    }

    public T getY() {
        return this.y;
    }
}
```

* æ­¤æ—¶Pointä¸­çš„x,yæ•°æ®ç±»å‹å¹¶ä¸ç¡®å®šï¼Œè€Œæ˜¯ç”±å¤–éƒ¨å†³å®šã€‚
* ç”±äºæ³›å‹æ˜¯å±äºjdk1.5ä¹‹åçš„,ä»¥å‰æ²¡æœ‰ä½¿ç”¨æ³›å‹ï¼Œä¸ºäº†å…¼å®¹ä»¥å‰ï¼Œæ‰€ä»¥ä¸è®¾ç½®æ³›å‹ç±»å‹ï¼Œé»˜è®¤æ˜¯Objectä½œä¸ºç±»å‹ã€‚ä½†æ˜¯ç¼–è¯‘ä¼šæç¤ºè­¦å‘Šã€‚
* <strong>æ³›å‹åœ¨å®šä¹‰å®Œæˆåå¯ä»¥åœ¨å®ä¾‹åŒ–å¯¹è±¡çš„æ—¶å€™,å¯ä»¥è¿›è¡Œæ³›å‹ç±»å‹çš„è®¾ç½®,ä¸€æ—¦è®¾ç½®ä¹‹åï¼Œä½¿ç”¨æ³›å‹çš„ç±»å†…éƒ¨ä½¿ç”¨çš„ç±»å‹å°±ä¸å½“å‰å¯¹è±¡ç›´æ¥ç»‘å®šäº†</strong>

```java
public static void main(String[] args) {
    Point<Integer> p = new Point<Integer>();
    p.setX(10);// è‡ªåŠ¨è£…ç®±
    p.setY(20);
    // è·å–xï¼Œy
    int x = p.getX();
    int y = p.getY();
    System.out.println("x=" + x + "ã€y=" + y);
    // x=10ã€y=20
}
```

* æ³›å‹çš„ç±»å‹è®¾ç½®ï¼Œåªä½¿ç”¨å½“å‰på®ä¾‹å¯¹è±¡ã€‚è¿™æ ·ç¼–è¯‘æ—¶å°±å¯ä»¥å‘ç°ç±»å‹é”™è¯¯ï¼Œé¿å…å®‰å…¨éšæ‚£

* æ³¨æ„
    * æ³›å‹ä¹‹ä¸­åªå…è®¸è®¾ç½®å¼•ç”¨ç±»å‹,å¦‚æœè¦æ“ä½œåŸºæœ¬ç±»å‹ï¼Œå¿…é¡»ä½¿ç”¨åŒ…è£…ç±»ã€‚
    * ä»jdk1.7å¼€å§‹æ³›å‹å®ä¾‹åŒ–ï¼Œå¯ä»¥ç®€åŒ–ä¸ºPoint<Integer> p = new Point<>();

## æ³›å‹é€šé…ç¬¦

* é—®é¢˜ï¼šå¼•ç”¨ä¼ é€’å¤„ç†

```java
class Message<T> {
    private T content;

    public void setContent(T content) {
        this.content = content;
    }

    public T getContent() {
        return this.content;
    }
}

public class JavaDemo13 {
    public static void main(String args[]) {
        Message<String> c = new Message<String>();
        c.setContent("content");
        fun(c);
    }

    public static void fun(Message<String> temp) {
        System.out.println(temp.getContent());
    }
}
```

* é—®é¢˜åœ¨funæ–¹æ³•ä¸Šï¼Œä½¿ç”¨æ³›å‹ä¸å¯èƒ½æ˜¯ä¸€ç§ç±»å‹ã€‚ä¸Šåˆ—åªèƒ½å¤Ÿæ¥æ”¶Message<String>ç±»å‹

* æ³›å‹é€šé…ç¬¦â€œï¼Ÿâ€å¯ä»¥è·å–æ³›å‹ä¸­çš„æ•°æ®ï¼Œä½†æ˜¯ä¸å¯ä»¥ä¿®æ”¹ã€‚

```java
public class JavaDemo13 {
    public static void main(String args[]) {
        Message<String> c = new Message<String>();
        c.setContent("content");
        fun(c);
        Message<Integer> d = new Message<Integer>();
        d.setContent(111);
        fun(d);
    }

    public static void fun(Message<?> temp) {
        System.out.println(temp.getContent());
    }
}
```

* "?"é€šé…ç¬¦æ‰©å±•
    * ?extends ç±»ï¼šè®¾ç½®æ³›å‹çš„ä¸Šé™
        * ? extends Number ï¼šè¡¨ç¤ºè¯¥æ³›å‹åªå…è®¸è®¾ç½®Numberæˆ–Numberçš„å­ç±»
    * ?super ç±»ï¼šè®¾ç½®æ³›å‹çš„ä¸‹é™
        * ? super String ï¼šè¡¨ç¤ºåªèƒ½å¤Ÿä½¿ç”¨Stringæˆ–å…¶çˆ¶ç±»ã€‚

* æ³›å‹ä¸Šé™ğŸŒ°

```java

class Message<T extends Number> {//è®¾ç½®ä¸Šé™
    private T content;

    public void setContent(T content) {
        this.content = content;
    }

    public T getContent() {
        return this.content;
    }
}

public class JavaDemo13 {
    public static void main(String args[]) {
        // Stringä¼šæŠ¥é”™
        // Message<String> c = new Message<String>();
        // c.setContent("content");
        // fun(c);
        Message<Integer> d = new Message<Integer>();
        d.setContent(111);
        fun(d);
    }
    //? extends Number è®¾ç½®ä¸Šé™
    public static void fun(Message<? extends Number> temp) {
        System.out.println(temp.getContent());
    }
}
```

* æ³›å‹ä¸‹é™ğŸŒ°

```java

class Message<T> {
    private T content;

    public void setContent(T content) {
        this.content = content;
    }

    public T getContent() {
        return this.content;
    }
}

public class JavaDemo13 {
    public static void main(String args[]) {
        Message<String> c = new Message<String>();
        c.setContent("content");
        fun(c);
        // Message<Integer> d = new Message<Integer>();
        // d.setContent(111);
        // fun(d);
    }
    //åªèƒ½ä¼ é€’Stringæˆ–è€…Stringçˆ¶ç±» Object
    public static void fun(Message<? super String> temp) {
        System.out.println(temp.getContent());
    }
}
```

## æ³›å‹æ¥å£

```java
interface IMessage<T> {
    public String echo(T t);
}
```

* å¯¹äºæ³›å‹å­ç±»è€Œè¨€ï¼Œæœ‰ä¸¤ç§å­ç±»å®ç°æ–¹å¼ã€‚
    * æ–¹å¼ä¸€ï¼šåœ¨å­ç±»ä¹‹ä¸­ç»§ç»­è®¾ç½®æ³›å‹å®šä¹‰ã€‚

    ```java
    interface IMessage<T> {
        public String echo(T t);
    }
    //å®ç°æ¥å£æ˜¯ ç»§ç»­ä½¿ç”¨æ³›å‹
    class MessageImpl<S> implements IMessage<S> {
        @Override
        public String echo(S t) {
            return "ã€echoã€‘" + t;
        }
    }

    public class JavaDemo14 {
        public static void main(String[] args) {
            IMessage<String> msg = new MessageImpl<String>();
            System.out.println(msg.echo("123"));
            //ã€echoã€‘123
        }
    }
    ```
    * æ–¹å¼äºŒï¼š åœ¨å­ç±»å®ç°çˆ¶æ¥å£çš„æ—¶å€™ç›´æ¥å®šä¹‰å‡ºå…·ä½“çš„æ³›å‹
    
    ```java
        interface IMessage<T> {
            public String echo(T t);
        }
        // å®ç°æ¥å£ ç›´æ¥æŒ‡å®šString
        class MessageImpl implements IMessage<String> {
            @Override
            public String echo(String t) {
                return "ã€echoã€‘" + t;
            }
        }

        public class JavaDemo14 {
            public static void main(String[] args) {
                IMessage<String> msg = new MessageImpl();
                System.out.println(msg.echo("123"));
                //ã€echoã€‘123
            }
        }
    ```

## æ³›å‹æ–¹æ³•

* æœ‰æ³›å‹æ ‡è®°çš„æ–¹æ³•

```java

public class JavaDemo15 {
    public static void main(String[] args) {
        Integer[] num = fun(1, 2, 3);
        for (int item : num) {
            System.out.println(item);
        }
    }

    public static <T> T[] fun(T... args) {
        return args;
    }
}
```
![](../img/ä¼ ç»Ÿå·¥å‚.png)
![](../img/ä¼ ç»Ÿå·¥å‚2.png)

* åˆ©ç”¨æ³›å‹æ”¹è¿›å·¥å‚